---
import LazyImage from '../common/LazyImage.astro';
import { getLocale } from '../../i18n/i18n';
import { Image } from 'astro:assets';
import { fade } from 'astro:transitions';

interface Props {
  image: string;
  title: string;
  time?: string;
  id: string;
  textColor?: string;
  iconColor?: string;
  hoverImage?: string;
  difficulty?: string;
  servings?: number;
  rating?: number;
  isMainCard?: boolean;
}

const { 
  image, 
  title, 
  time = "---", 
  id,
  textColor = 'text-blue-900',
  iconColor = 'text-blue-900',
  hoverImage = image,
  difficulty = "---",
  servings = 0,
  rating = 0,
  isMainCard = false
} = Astro.props;

const currentLocale = getLocale();
const recipeLink = `/${currentLocale}/${currentLocale === 'es' ? 'recetas' : 'recipes'}/${id}`;
const viewRecipeText = currentLocale === 'es' ? 'Ver Receta' : 'View Recipe';
---

<a 
  href={recipeLink} 
  class={`block group relative transition-all duration-500 ease-in-out flex-shrink-0 ${
    isMainCard ? 'w-[530px] h-[562px]' : 'w-[310px] h-[562px]'
  }`}
  transition:animate="fade"
>
  <!-- Container principal con las medidas específicas -->
  <div class={`flex flex-col ${isMainCard ? 'w-[530px] h-[562px]' : 'w-[310px] h-[562px]'} relative`}>
    <!-- Overlay gris para tarjetas no principales: oculto en mobile para tener estado activo por defecto -->
    {!isMainCard && (
      <div class="absolute inset-0 bg-[#0A0A0A40] z-10 rounded-[30px] hidden md:block"></div>
    )}
    
    <!-- Imagen -->
    <div class={`relative overflow-hidden flex-shrink-0 ${
      isMainCard 
        ? 'w-[530px] h-[300px] rounded-t-[30px] border-t border-r border-l border-[#388BFF]' 
        : 'w-[310px] h-[300px] rounded-t-[30px] border-t border-r border-l border-black border-opacity-50'
    }`}>
      <LazyImage
        src={image}
        alt={title}
        class="w-full h-full object-cover"
        transition:name={`recipe-image-${id}`}
      />
    </div>
    
    <!-- Información -->
    <div class={`flex-shrink-0 ${
      isMainCard 
        ? 'w-[530px] h-[262px] bg-[#F8E31F] rounded-b-[30px] border-r border-b border-l border-black border-opacity-50' 
        : 'w-[310px] h-[262px] bg-[#F8E31F] rounded-b-[30px] border border-black border-opacity-50'
    } p-6 flex flex-col justify-between`}>
      <!-- Título -->
      <h3 class="font-title font-bold text-black leading-tight flex-1 flex items-center text-2xl">{title}</h3>
      
      <!-- Botón Ver Receta -->
      <div class="flex justify-center">
        <div class="flex py-5 px-2.5 justify-center w-full items-center gap-2.5 rounded-[15px] border border-[#388BFF66] bg-[#FFED41] text-black text-xl font-bold hover:bg-yellow-300 transition-colors">
          {viewRecipeText}
        </div>
      </div>
    </div>
  </div>
</a>
